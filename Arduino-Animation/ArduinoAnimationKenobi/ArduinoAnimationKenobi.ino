// Author : Aldo Gordoni
// Date   : 04/03/2022

#include<Arduino.h>
#include<U8g2lib.h>
#include<Wire.h>

U8G2_SSD1306_128X64_NONAME_F_HW_I2C u8g2(U8G2_R0, /* reset=*/ U8X8_PIN_NONE);

// Copy the contents of your .xbm file below
#define kenobi_width 50
#define kenobi_height 50
const static unsigned char kenobi_array[1][458] PROGMEM = {
  { //kenobi picture
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF0, 
  0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFE, 0x0F, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0xFF, 0xFF, 0x01, 0x00, 0x00, 0x00, 0xC0, 0xDF, 0xFF, 0x01, 0x00, 
  0x00, 0x00, 0xE0, 0xF3, 0x87, 0x03, 0x00, 0x00, 0x00, 0xF0, 0x7D, 0x00, 
  0x07, 0x00, 0x00, 0x00, 0x78, 0x32, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x38, 
  0x09, 0xC0, 0x21, 0x00, 0x00, 0x00, 0x9C, 0x06, 0xF8, 0x23, 0x00, 0x00, 
  0x00, 0x9C, 0x03, 0xF8, 0x47, 0x00, 0x00, 0x00, 0xCE, 0x00, 0xD0, 0xC7, 
  0x00, 0x00, 0x00, 0x6E, 0x08, 0xF0, 0xCF, 0x00, 0x00, 0x00, 0x36, 0x05, 
  0xF0, 0x8F, 0x00, 0x00, 0x00, 0x9F, 0x00, 0xE7, 0x8F, 0x00, 0x00, 0x00, 
  0xDF, 0x00, 0xE0, 0x9F, 0x00, 0x00, 0x00, 0x4F, 0x00, 0xD0, 0x9F, 0x00, 
  0x00, 0x00, 0x6F, 0x00, 0xF2, 0xBF, 0x00, 0x00, 0x00, 0x27, 0x80, 0xFF, 
  0xBF, 0x00, 0x00, 0x00, 0xB7, 0x81, 0x7F, 0x3E, 0x00, 0x00, 0x00, 0xFF, 
  0xCD, 0x7F, 0x7E, 0x00, 0x00, 0x00, 0xEF, 0x81, 0x3B, 0x7C, 0x00, 0x00, 
  0x00, 0x6F, 0x00, 0x98, 0x7E, 0x00, 0x00, 0x00, 0x7D, 0x00, 0x30, 0x7F, 
  0x00, 0x00, 0x00, 0x7F, 0x10, 0x70, 0x3F, 0x00, 0x00, 0x00, 0xFE, 0x00, 
  0xF0, 0x3F, 0x00, 0x00, 0x00, 0xFA, 0x00, 0xF0, 0x3F, 0x00, 0x00, 0x00, 
  0xFE, 0x00, 0xF0, 0x3F, 0x00, 0x00, 0x00, 0xF6, 0x01, 0xFC, 0x3F, 0x00, 
  0x00, 0x00, 0xF6, 0x39, 0xFC, 0x3F, 0x00, 0x00, 0x00, 0xF0, 0x38, 0xE0, 
  0x3F, 0x00, 0x00, 0x00, 0xF0, 0x1C, 0xC0, 0x1F, 0x00, 0x00, 0x00, 0xF0, 
  0x0D, 0xE0, 0x1F, 0x00, 0x00, 0x00, 0xE0, 0xC1, 0xCC, 0x0F, 0x00, 0x00, 
  0x00, 0xE0, 0x3F, 0x80, 0x0F, 0x00, 0x00, 0x00, 0xE0, 0x1F, 0xE0, 0x0F, 
  0x00, 0x00, 0x00, 0xC0, 0x8F, 0xFF, 0x1F, 0x00, 0x00, 0x00, 0xC0, 0x0F, 
  0xFC, 0x1F, 0x00, 0x00, 0x00, 0xE0, 0x07, 0x72, 0x3F, 0x00, 0x00, 0x00, 
  0xFE, 0x07, 0x78, 0x7F, 0x00, 0x00, 0xC0, 0xFF, 0x1F, 0x7C, 0xFB, 0x01, 
  0x00, 0xFC, 0xF7, 0x1F, 0xF4, 0xFB, 0x1F, 0x00, 0xFF, 0x37, 0x1E, 0xF0, 
  0xF9, 0xFF, 0x00, 0xFF, 0x3B, 0x3C, 0xF8, 0x7D, 0xFF, 0x03, 0xFF, 0x3B, 
  0x7C, 0xFC, 0x7C, 0xFF, 0x03, 0x7F, 0x3B, 0xF8, 0x3C, 0x3E, 0xFF, 0x03, 
  0xFF, 0x3B, 0xE0, 0x1F, 0x1E, 0xFF, 0x03, 0x7F, 0x7B, 0xC0, 0x07, 0x1F, 
  0xFF, 0x03
  }
};

void drawAnimation(void) {
  // play images and animatio in our desired sequence order
  static uint8_t pointer = 0 ;
  static uint8_t yKenobi = 10;
  static uint8_t changeText = 0;
  
  u8g2.drawXBMP( 40, yKenobi, kenobi_width, kenobi_height, kenobi_array[0]);
  
  if(changeText<139){
    u8g2.setFont(u8g2_font_sticker_mel_tr);
    u8g2.drawStr(45,yKenobi-40,"Hello");
  } else {
    u8g2.setFont(u8g2_font_sticker_mel_tr);
    u8g2.drawStr(40,yKenobi-40,"There");
  }
  
  if(pointer<70){
    yKenobi++;
  } else {
   yKenobi--;
  }
  pointer++;
  changeText++;
  
  if(pointer>139){
    pointer = 0;
  }
  if(pointer>279){
  }
}

void setup(void) {
  u8g2.begin();
}

void loop(void) { 
  u8g2.firstPage();
  do {
    drawAnimation();
  } while ( u8g2.nextPage() );  
}
